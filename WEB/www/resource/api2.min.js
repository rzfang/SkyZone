"use strict";function Z_Check_API(){function t(){return{Boolean:function(t){return"boolean"==typeof t},Number:function(t){return"number"==typeof t},String:function(t){return"string"==typeof t},Function:function(t){return"function"==typeof t},Object:function(t){return"object"==typeof t},Undefined:function(t){return"undefined"==typeof t},Array:function(t){return t instanceof Array},EMail:function(t){return"string"!=typeof t?!1:/^[\w.]+@.{2,16}\.[0-9a-z]{2,3}$/.test(t)}}}window&&(window.Is=t())}function Trim(t){return t.replace(/^\s+|\s+$/g,"")}function StringLength(t){if("string"!=typeof t)return 0;for(var e=0,n=t.length,r=0;n>r;r++){var a=t.charCodeAt(r);(32>a||a>126)&&e++}return t.length+e}function SubStrFx(t,e,n){"string"!=typeof t&&(t=t.toString()),("number"!=typeof e||0>e)&&(e=0),t=t.substr(e),("number"!=typeof n||1>n)&&(n=t.length);for(var r="",a=0,i=0;n>i&&n>a;i++){r+=t.charAt(i);var o=t.charCodeAt(i);(32>o||o>126)&&++a,++a}return r}function CSSAdd(t,e){if("string"!=typeof t||0===t.length)return-1;if("string"==typeof e&&e.length>0){if(document.getElementById(e))return 1}else e="";var n=document.createElement("style"),r=document.createTextNode(t);return e.length>0&&(n.id=e),n.type="text/css",n.styleSheet?n.styleSheet.cssText=r.nodeValue:n.appendChild(r),document.getElementsByTagName("head")[0].appendChild(n),0}function ObjectCombine(t,e,n){if("object"!=typeof t||"object"!=typeof e)return null;"number"!=typeof n&&(n=0);var r={};for(var a in t)r[a]=t[a];if(0===n)for(var a in e)r[a]=e[a];else for(var a in e)"undefined"!=typeof r[a]&&(r[a]=e[a]);return r}function CharPad(t,e,n,r){if("string"!=typeof t&&(t=t.toString()),"number"!=typeof e||2>e||t.length>=e)return t;if(("string"!=typeof n||0===n.length)&&(n="0"),"string"!=typeof r)r="l";else if(r=r.toLowerCase(),"l"!==r&&"r"!==r)return t;var a=e-t.length,i="";for(i="";i.length<a;i+=n);return"l"===r?t=i+t:t+=i,t}function Second2Datetime(t,e){var n=new Date(1e3*t),r="",a=n.getTimezoneOffset(),i=a/60;switch(t=parseFloat(t),"number"!=typeof e&&(e=0),e=parseInt(e,10),i=(i>0?"-":"+")+CharPad(Math.abs(i),2),e){case 1:n.setMinutes(n.getMinutes()-a),r=n.toJSON().substr(0,19).replace("T"," ");break;case 2:r=""+n.getFullYear()+CharPad(n.getMonth()+1,2)+CharPad(n.getDate(),2)+CharPad(n.getHours(),2)+CharPad(n.getMinutes(),2)+CharPad(n.getSeconds(),2);break;case 0:default:r=n.getFullYear()+"-"+CharPad(n.getMonth()+1,2)+"-"+CharPad(n.getDate(),2)+" "+CharPad(n.getHours(),2)+":"+CharPad(n.getMinutes(),2)+":"+CharPad(n.getSeconds(),2)+"."+CharPad(n.getMilliseconds(),3)+i}return r}function FileSizeNormalize(t){if("number"!=typeof t&&(t=parseInt(t,10)),isNaN(t)||0>t)return"???";for(var e=["KB","MB","GB"],n=e.length;n>0;n--){var r=Math.pow(2,10*n);if(t>r)return t=Math.round(t/r*100)/100,t.toString()+" "+e[n-1]}return t+" Bytes"}function IsTimeStamp(t){return"string"!=typeof t||0===t.length?!1:RECheck(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/,t)}function IsEMail(t){return RECheck(/^[\w.]+@.{2,16}\.[0-9a-z]{2,3}$/,t)}function RECheck(t,e){if("function"!=typeof t&&"object"!=typeof t&&"string"!=typeof t||"string"!=typeof e)return!1;var n=new RegExp(t);return n.test(e)}function CookieSet(t,e,n,r,a){if("string"!=typeof t||"undefined"==typeof e||null===e||"number"!=typeof n||null===n)return-1;var i=new Date;i.setTime(i.getTime()+1e3*n);var o=t+"="+encodeURIComponent(e)+";expires="+i.toUTCString()+";";return"string"==typeof r&&r.length>0&&(o+="path="+r+";"),"string"==typeof a&&a.length>5&&(o+="domain="+a+";"),document.cookie=o,0}function CookieParam(){var t=document.cookie.split(";"),e={};for(var n in t){var r=t[n].replace(/^\s+|\s+$/g,"").split("=");e[r[0]]=decodeURIComponent(r[1])}return e}function PageTurn(t){return"string"!=typeof t?0:void(t.length>0?window.location=t:window.location.reload(!0))}function WindowViewSize(){var t=[0,0];return document.documentElement?t=[document.documentElement.clientWidth,document.documentElement.clientHeight]:window.innerWidth&&window.innerHeight&&(t=[window.innerWidth,window.innerHeight]),t}function PageNameGet(){var t=window.location.pathname.split("/");return t[t.length-1]}function EmbedDeny(){top!=self&&(window.location.href="about:blank")}function HTMLSpecialCharsEnDeCode(t,e){return"string"!=typeof t||"boolean"!=typeof e?"":e?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t.replace(/&amp;|&#0?38;/g,"&").replace(/&lt;|&#0?60;/g,"<").replace(/&gt;|&#0?62;/g,">").replace(/&quot;|&#0?34;/g,'"').replace(/&#0?39;/g,"'")}function TextToHTML(t){return"string"!=typeof t||0===t.length?t:t=t.replace(/(https?:\/\/\S+)/g,'<a href="$1" target="_blank">$1</a>')}function RandomRange(t,e,n){if("number"!=typeof t||"number"!=typeof e)return 0;if("number"!=typeof n&&(n=0),t>e||t>e){var r=t;t=e,e=r}var a=e-t,i=Math.random()*a+t;if(0===n)i=Math.floor(i);else if(n>0){var o=Math.pow(10,n);i=Math.floor(i*o)/o}return i}function URLParameters(){var t=window.location.search,e={};if(t.length>0)for(var n=t.substr(1).split("&"),r=0;r<n.length;r++){var a=n[r].split("=");e[a[0]]=a.length<2?!0:a[1]}return e}function TabBox(t,e,n,r,a){function i(){s($(this))}function o(){var t=window.location.hash.replace(/^#/,"");if(0===t.length)return s(u.children(":first")),0;var e=RegExp(a+"\\d+,?","g"),n=t.match(e),r=0;null!==n&&(r=parseInt(n[n.length-1].match(/\d+/),10)),s(u.children(":eq("+r.toString()+")"))}function s(t){var e=t,n=e.index(),a=d.data("IdxRcd");if(a[1]===n)return 0;var i=e,o=i.siblings(".PckTb").removeClass("PckTb");i.addClass("PckTb"),a[0]=a[1],a[1]=n,d.data("IdxRcd",a),c.eq(a[1]).show(),a[0]>=0&&c.eq(a[0]).hide(),r(o,i)}if("undefined"==typeof t||"string"!=typeof e)return alert("Tab Bx initialize failed."),null;("number"!=typeof n||0>n)&&(n=0),"function"!=typeof r&&(r=function(){});var d=$(t).data("IdxRcd",[-1,-1]),c=$(e),l=$("<li/>"),f="",u=d.prepend("<ul/>").children("ul:first");if(f=t+" > ul { margin: 0px; padding: 0px; }\n"+t+" > ul > li { display: inline-block; position: relative; border-style: solid; vertical-align: bottom; cursor: pointer; }\n"+e+" { display: none; min-height: 100px; border-style: solid; }",CSSAdd(f),"string"!=typeof a||0===a.length)c.each(function(t){{var e=$(this),n=[e.data("tabName"),e.attr("name")];l.clone().text(n[0]?n[0]:n[1]?n[1]:t.toString()).appendTo(u)}}),u.on("click",">  li",i);else{var p=window.location.hash.replace(/^#/,""),h=new RegExp(a+"\\d+,?","g"),g=p.match(h);null!==g&&(g=g[g.length-1].match(/\d+/),n=parseInt(g[0],10)),c.each(function(t){{var e=$(this),n=[e.data("tabName"),e.attr("name")];l.clone().text(n).attr("name",a+t.toString()).appendTo(u)}}),u.on("click","> span",HashToTabSwitch),$(window).on("hashchange",o)}return s(u.children("li:eq("+n+")")),d}function Button0(t){function e(t){"boolean"!=typeof t.LckFlg&&($(t).attr("autocomplete","off"),t.LckFlg=!1,t.Lock=n,t.Unlock=r)}function n(){this.LckFlg||(this.LckFlg=!0,$(this).addClass("Lock").prop("disabled",!0))}function r(){this.LckFlg&&(this.LckFlg=!1,$(this).removeClass("Lock").prop("disabled",!1))}return"string"!=typeof t?(alert("Set 'Button0' object failed. Please check out passing values."),null):(t=Trim(t),$("body").on("mouseenter",t,function(t){e(t.currentTarget)}).on("focus",t,function(t){e(t.currentTarget)}).find(t).each(function(){e(this)}),0)}function ItemList(t,e,n,r,a,i,o){function s(t){var s=typeof t;if("undefined"===s)t=p;else if("number"!==s)return 0;var d=ObjectCombine(r,{Lmt:n,Ofst:t*n});$.ajax({type:"POST",dataType:"json",timeout:2e4,url:e,data:d,success:function(e){if(0!=e.Index)return alert(e.Index+", "+e.Message),0;p=t,f.empty();for(var n in e.Extend)f.append(a(e.Extend[n],n));("object"==typeof i||i.length>1)&&l(),"function"==typeof o&&o("undefined"==typeof e.Extend?0:e.Extend.length,e.Extend)}})}function d(t){var a=ObjectCombine(r,{Cnt:1,Lmt:0,Ofst:0});$.ajax({type:"POST",dataType:"json",timeout:2e4,url:e,data:a,success:function(e){return 0!=e.Index?(alert(e.Index+", "+e.Message),0):(g=isNaN(e.Extend)?e.Extend.length:e.Extend,m=Math.ceil(g/n)-1,0==e.Extend&&"object"==typeof i&&i.length>1&&l(),void("function"==typeof t&&t()))}})}function c(t){return"number"!=typeof t||1>t?Limit:(t>99&&(t=99),n=t)}function l(){var t=$("<div/>").appendTo(f),e=["",""];if("object"!=typeof i||0===i.length)return 0;t.addClass("ItmLstIdxBx").css({textAlign:"center",marginTop:10}),"string"==typeof i[0]&&i[0].length>0&&(e[0]=i[0]),"string"==typeof i[1]&&i[1].length>0&&(e[1]=i[1]),$("<span/>").addClass(p>0?e[0]:e[1]).attr({name:p>0?0:-1,title:1}).text("╞").appendTo(t),$("<span/>").addClass(0==p?e[1]:e[0]).attr({name:p-1}).text("◁").appendTo(t);var n=$("<span/>").addClass(e[1]).attr("name",p).text(p+1).appendTo(t);$("<span/>").addClass(p>=m?e[1]:e[0]).attr({name:p+1}).text("▷").appendTo(t),$("<span/>").addClass(m>p?e[0]:e[1]).attr({name:m>p?m:m+1,title:m+1}).text("╡").appendTo(t);var r=p-h,a=p,o=p+h,s=p;0>r&&(o-=r,r=0,o>m&&(o=m)),o>m&&(r-=o-m,o=m,0>r&&(r=0));for(var d=r;a>d;d++)$("<span/>").addClass(e[0]).attr({name:d}).text(d+1).insertBefore(n);for(var d=o;d>s;d--)$("<span/>").addClass(e[0]).attr({name:d}).text(d+1).insertAfter(n)}if("undefined"==typeof t||"string"!=typeof e||isNaN(n)||"object"!=typeof r||"function"!=typeof a)return alert("Create a 'ItemList' failed. Please check out passing values."),null;n=parseInt(n,10),1>n&&(n=0);var f=$(t),u=f.get(0),p=0,h=2,g=0,m=0;return f.data("Data",r),u.PageGet=s,u.Recount=d,u.LimitSet=c,u.NowPage=function(){return p},d(function(){s(p)}),"object"==typeof i&&i.length>0&&f.off("click","div.ItmLstIdxBx:last-child > span").on("click","div.ItmLstIdxBx:last-child > span",function(){var t=$(this),e=parseInt(t.attr("name"),10);if(0>e||e>m||e===p)return 0;"string"==typeof i[1]&&i[1].length>0&&t.siblings().addBack().removeClass().addClass(i[1]),s(e)}),f}function ItemList2(t,e,n,r,a,i){function o(t){var e=this;Is.Number(t)||(t=this.NowPage+1),$.ajax({type:"POST",dataType:"json",timeout:2e4,url:this.URL,data:this.Data,error:function(){},success:function(n){var r;if(0!=n.Index||!Is.Array(n.Extend))return void alert(n.Index+", "+n.Message);r=$(e),e.Cln&&r.empty();for(var a=0;a<n.Extend.length;a++)r.append(e.OneItemCreate(n.Extend[a],a));e.Data.Ofst+=e.Data.Lmt,e.NowPage=t,e.AfterItemsCreate(n.Extend.length,n.Extend)}})}var s,d;return!Is.Undefined(t)&&Is.String(e)&&Is.Object(n)&&Is.Function(r)?(s=$(t),s.length?((!Is.Number(n.Lmt)||n.Lmt<0)&&(n.Lmt=10),(!Is.Number(n.Ofst)||n.Ofst<0)&&(n.Ofst=0),d=s[0],d.URL=e,d.Data=n,d.Cln=Is.Boolean(a)?a:!0,d.NowPage=parseInt(d.Data.Ofst/d.Data.Lmt,10),d.PageGet=o,d.NowPageGet=function(){return this.NowPage},d.OneItemCreate=r,d.AfterItemsCreate=i||function(){},d):null):(console.log("create a 'ItemListV2' failed. please check out passing values."),null)}function PageIndex(t){function e(){var t=["",""];if("object"!=typeof IdxCls||0===IdxCls.length)return 0;IdxLst.addClass("ItmLstIdxBx").css({textAlign:"center",marginTop:10}),"string"==typeof IdxCls[0]&&IdxCls[0].length>0&&(t[0]=IdxCls[0]),"string"==typeof IdxCls[1]&&IdxCls[1].length>0&&(t[1]=IdxCls[1]),$("<span/>").addClass(NwPg>0?t[0]:t[1]).attr({name:NwPg>0?0:-1,title:1}).text("╞").appendTo(IdxLst),$("<span/>").addClass(0==NwPg?t[1]:t[0]).attr({name:NwPg-1}).text("◁").appendTo(IdxLst);var e=$("<span/>").addClass(t[1]).attr("name",NwPg).text(NwPg+1).appendTo(IdxLst);$("<span/>").addClass(NwPg>=MxPg?t[1]:t[0]).attr({name:NwPg+1}).text("▷").appendTo(IdxLst),$("<span/>").addClass(NwPg<MxPg?t[0]:t[1]).attr({name:NwPg<MxPg?MxPg:MxPg+1,title:MxPg+1}).text("╡").appendTo(IdxLst);var n=NwPg-PgTgRng,r=NwPg,a=NwPg+PgTgRng,i=NwPg;0>n&&(a-=n,n=0,a>MxPg&&(a=MxPg)),a>MxPg&&(n-=a-MxPg,a=MxPg,0>n&&(n=0));for(var o=n;r>o;o++)$("<span/>").addClass(t[0]).attr({name:o}).text(o+1).insertBefore(e);for(var o=a;o>i;o--)$("<span/>").addClass(t[0]).attr({name:o}).text(o+1).insertAfter(e)}var n=$("<div/>");return t&&"object"==typeof t?e()<0?-2:void t.append(n):-1}function Frame(t,e,n,r,a,i,o){function s(){function t(t,e){return t.ZIdx===e.ZIdx?0:t.ZIdx>e.ZIdx?1:-1}var e=-1,n=[];if(I.siblings("."+a).each(function(){var t=$(this),r=parseInt(t.css("zIndex"),10);e=Math.max(e,r),n.push({JO:t,ZIdx:r})}),e++,parseInt(I.css("zIndex"),10)==e)return 0;I.css("zIndex",e),n.push({JO:I,ZIdx:e});var r=n.length;if(r>1){n.sort(t);{n[0].ZIdx}n[0].ZIdx>0&&(n[0].JO.css("zIndex",0),n[0].ZIdx=0);for(var i=1;r>i;i++){var o=n[i-1].ZIdx+1;n[i].ZIdx>o&&(n[i].JO.css("zIndex",o),n[i].ZIdx=o)}}return 1}function d(t,e){if(t.hide(),s(),e)return t.children("div:eq(1)").append(r),0;var n=Math.round(3*Math.random());switch(n){case 1:t.slideDown("normal",function(){t.children("div:eq(1)").append(r)});break;case 2:t.fadeIn("normal",function(){t.children("div:eq(1)").append(r)});break;case 0:default:t.show("normal",function(){t.children("div:eq(1)").append(r)})}}function c(){var t=Math.round(3*Math.random());switch(t){case 1:I.slideUp("normal",function(){$(this).remove()});break;case 2:I.fadeOut("normal",function(){$(this).remove()});break;case 0:default:I.hide("normal",function(){$(this).remove()})}}function l(t){function e(t){I.css({left:t.pageX-b.X,top:t.pageY-b.Y})}var n=I.offset();return b.X=t.pageX-n.left,b.Y=t.pageY-n.top,s(),C.css("cursor","move").on("mousemove",e),I.css("border","1px solid rgba(255, 0, 0, 0.7)").data("IsMv",!0),$(t.currentTarget).css("cursor","move").off("click").on("click",f),0}function f(t){C.css({cursor:""}).off("mousemove"),I.css("border","").data("IsMv",!1),$(t.currentTarget).css("cursor","pointer").off("click").on("click",l)}function u(t){function e(t){var e=t.pageX-b.X,r=t.pageY-b.Y,a=b.W+e,i=b.H-r;r+=n.top,200>a&&(a=200),200>i?i=200:I.css("top",r),I.children("div:eq(1)").css({width:a,height:i})}var n=I.offset(),r=I.children("div:eq(1)");return b.X=t.pageX,b.Y=t.pageY,b.W=r.width(),b.H=r.height(),s(),C.css("cursor","ne-resize").on("mousemove",e),I.css("border","1px solid rgba(255, 0, 0, 0.7)").data("IsRsz",!0),$(t.currentTarget).css("cursor","ne-resize").off("click",u).on("click",p),0}function p(t){C.css({cursor:""}).off("mousemove"),I.css("border","").data("IsRsz",!1),$(t.currentTarget).css("cursor","pointer").off("click",p).on("click",u)}function h(t){var e=I.children("div:eq(1)"),n=[e.width(),e.height()],r=I.offset(),a=C.width()-(I.outerWidth()-n[0]),i=$(document).height()-(I.outerHeight()-n[1]);s(),$(t.currentTarget).data("LstSt",{X:r.left,Y:r.top,W:n[0],H:n[1]}).off("click",h).on("click",g).prevAll("span").hide(),I.css({left:0,top:0}),e.css({width:a,height:i})}function g(t){var e=I.children("div:eq(1)"),n=$(t.currentTarget).off("click",g).on("click",h).prevAll("span").show().end().data("LstSt");I.css({left:n.X,top:n.Y}),e.css({width:n.W,height:n.H})}function m(t,e){function n(){setTimeout(function(){I.data("IsRsz")||e(r)},0)}if("string"!=typeof t||0===t.length||"function"!=typeof e)return null;var r=this,a=T.find("> span:last > span");switch(t){case"CloseButtonClick":a.last().off("click").on("click",function(){e(r)});break;case"SizeChange":a.eq(1).on("click",n).end().eq(2).on("click",n)}return this}var v="FrmIcnBtn";if(0===$("#"+v).length){var x="."+a+" > div:first-child {  padding: 1px 5px; border-radius: 5px 5px 0px 0px; font-size: 18px; border-bottom-width: 1px;  background-image:         linear-gradient(to bottom, rgba(200, 240, 255, 1), rgba(240, 248, 255, 0.9));  background-image: -webkit-linear-gradient(top, rgba(200, 240, 255, 1), rgba(240, 248, 255, 0.9)); }\n."+a+" { border-width: 1px; border-radius: 5px; box-shadow: -1px 1px 2px; }\n."+a+" > div:nth-child(2) { padding: 5px; background-color: rgba(240, 240, 240, 0.9); }\n."+a+" > div:nth-child(3) { padding: 1px 3px; border-top-width: 1px; border-radius: 0px 0px 5px 5px; background-color: rgba(248, 248, 255, 0.9); }\n";CSSAdd(x,v)}if("undefined"==typeof t||"number"!=typeof e||"number"!=typeof n||"function"!=typeof r||"string"!=typeof a||0===a.length)return alert("Create a 'Frame' object failed. Please check out passing values."),null;"boolean"!=typeof o&&(o=!1);var C=$(t),b={X:0,Y:0,W:0,H:0},I=$('<span><div class="Hdr"><span/><span><span/><span/><span/><span/></span></div><div class="Ctn"/></span>').data({IsMv:!1,IsRsz:!1}).on("click","> *",function(){s()}).appendTo(C),w=I.get(0),T=I.addClass(a).css({display:"inline-block",position:"absolute"}).children("div:eq(1)").css({position:"relative",width:e,height:n,overflow:"auto",whiteSpace:"nowrap"}).end().children("div:first");return T.css({position:"relative",minHeight:"28px"}).children("span:first").css({display:"inline-block"}).text("string"==typeof i?i:"").end().children("span:last").css({position:"absolute",right:3,top:1,textAlign:"right"}).children("span").first().addClass("FIB FIB_Move").attr("title","移動").on("click",l).end().eq(1).addClass("FIB FIB_Resize").attr("title","調整大小").on("click",u).end().eq(2).addClass("FIB FIB_Max").attr("title","最大/復原").on("click",h).end().last().addClass("FIB FIB_Close").attr("title","關閉").click(c),w.ActionExtend=m,w.ToFront=s,d(I,o),I}function Animation(t,e,n){function r(){this.RunB=!0,this.FrameDraw()}function a(){this.RunB=!1}function i(){if(this.RunB){this.BgDrwF(this.Ctx,this.ScnSz);for(var t=0;t<this.ItmDrwFA.length;t++)this.ItmDrwFA[t](this.Ctx,this.ScnSz);setTimeout(function(){d.FrameDraw()},50)}}function o(t){return"function"!=typeof t?-1:(this.ItmDrwFA.push(t),0)}function s(t){return"number"!=typeof t||t>=this.ItmDrwFA.length?-1:void this.ItmDrwFA.splice(t,1)}if("object"!=typeof t||null===t||"object"!=typeof e||"number"!=typeof e.length)return void console.log("Animation is not going to run.");var d=this;this.DOM=null,this.Ctx=t.getContext("2d"),this.ScnSz={W:t.width,H:t.height},this.RunB=!1,this.BgDrwF=function(){},this.ItmDrwFA=[],this.Start=r,this.Stop=a,this.FrameDraw=i,this.ItemDrawAdd=o,this.ItemDrawDel=s;for(var c=0;c<e.length;c++)"function"==typeof e[c]&&this.ItmDrwFA.push(e[c]);this.BgDrwF="function"==typeof n?n:function(){this.Ctx.fillStyle="rgba(255, 255, 255, 1)",this.Ctx.fillRect(0,0,this.ScnSz.W,this.ScnSz.H)}}function FrameShow(t,e,n,r){if("object"!=typeof t)return 0;if(e="number"!=typeof e?t.css("left"):e,n="number"!=typeof n?t.css("top"):n,"function"!=typeof r&&(r=function(){}),t.get(0).ToFront(),"none"!==t.css("display"))return t.animate({left:e,top:n}),0;var a=Math.round(3*Math.random());switch(t.css({left:e,top:n}),a){case 1:t.slideDown("normal",r);break;case 2:t.fadeIn("normal",r);break;case 0:default:t.show("normal",r)}}function FrameHide(t){var e=Math.round(3*Math.random());switch(e){case 1:t.slideUp("normal");break;case 2:t.fadeOut("normal");break;case 0:default:t.hide("normal")}}function RelatedFrameRectangle(t,e,n){if("object"!=typeof t||"object"!=typeof e)return 0;("object"!=typeof n||n.length<2)&&(n=[0,0]);var r=$("#Main"),a=r.offset(),i=[a.left,a.top,r.innerWidth(),r.innerHeight()],o=t.offset(),s=[o.left,o.top,t.innerWidth(),t.innerHeight()],d=[s[0]+s[2]+n[0]+5,s[1]+n[1],e[0],e[1]];return d[0]+d[2]>i[2]+i[0]&&(d[0]=s[0]-d[2]-5+i[0]+n[0]),d[0]<i[0]&&(d[0]=i[0]+n[0]),d[1]+d[3]>i[3]+i[1]&&(d[1]=i[3]-d[3]+i[1]-5),d[1]<i[1]&&(d[1]=i[1]+5),d}function BaseFrameXGet(t){if("object"!=typeof t)return 0;for(var e=[$("#BlgLstFrm"),$("#MsgBrdFrm"),$("#TtlLstFrm")],n=0,r=99999,a=0;a<e.length;a++)if(void 0!==e[a]&&0!==e[a].length&&t.attr("id")!==e[a].attr("id")&&"none"!==e[a].css("display")){var i=e[a].offset();n=Math.max(n,i.left+e[a].width()+5),r=Math.min(r,i.left-5)}99999===r&&(r=0);var o=t.width();return r>o?r-o:n}function AboutFrame(t){function e(){return TabBox("#AbtBx","#AbtBx > div.AbtPg",0)}var n="ItdFrm",r=$("#"+n);if(r.length>0)return FrameShow(r),0;r=Frame("#Main",640,480,e,"Frm",t,!0),r.attr({id:n}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(r)});var a=$("#Main");return FrameShow(r,(a.width()-r.outerWidth())/2,a.offset().top+5),0}function BlogListFrame(t){function e(){var t=$("#BlogLstBx"),e=t.parent(),o=e.find("> div:first > input:button");return ItemList(t,"service.php",5,{Cmd:1},n,["LstIdxTg","LstIdxTgDsb"]),o.first().on("click",a).end().eq(1).on("click",r),t.on("click",".OneBlog",i),e}function n(t){var e=$("#OneBlog").clone().removeAttr("id");if(e.attr("id",t.ID).data("Pswd",t.Pswd).children("div:first").text(t.Ttl).end().children("div:eq(2)").text(t.Smry).end().find("> div:last > span:last").text(t.Dt.substr(0,10)),"object"==typeof t.Tg&&t.Tg.length>0)for(var n in t.Tg){var r=t.Tg[n];$("<span/>").text(r.Nm).attr("name",r.ID).appendTo(e.children("div:eq(1)"))}if(t.Pswd.length>0){var a=$("<span/>");a.addClass("IcoBlogTp IcoBlogLck").attr({title:"上鎖的文章"}).prependTo(e.find("> div:last > span:last"))}switch(t.Tp){case"text":$("<span/>").addClass("IcoBlogTp IcoBlogTxt").attr({title:"文章"}).prependTo(e.find("> div:last > span:last"));break;case"image":$("<span/>").addClass("IcoBlogTp IcoBlogImg").attr({title:"圖文"}).prependTo(e.find("> div:last > span:last"));break;case"images":$("<span/>").addClass("IcoBlogTp IcoBlogImgs").attr({title:"相簿"}).prependTo(e.find("> div:last > span:last"))}return e}function r(t){t.stopPropagation(),$(t.currentTarget).attr({id:"00000000000000000000000000000000",name:"random"}),i(t)}function a(t){function e(t){t.stopPropagation(),$(this).closest("div").prev("div").find("input:checkbox").prop("checked",!1),ItemList("#BlogLstBx","service.php",5,{Cmd:1,TgIDA:[]},n,["LstIdxTg","LstIdxTgDsb"]),FrameHide(i)}function r(t){t.stopPropagation();var e=[];$(this).closest("div").prev("div").find("input:checkbox:checked").each(function(){e.push($(this).val())}),ItemList("#BlogLstBx","service.php",5,{Cmd:1,TgIDA:e},n,["LstIdxTg","LstIdxTgDsb"]),FrameHide(i)}t.stopPropagation();var a="TgLstFrm",i=$("#"+a),o=[0,0];return"object"==typeof i&&i.length>0?(o=RelatedFrameRectangle(s,[i.outerWidth(),i.outerHeight()]),FrameShow(i,o[0],o[1]),1):($.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:{Cmd:7},success:function(t){if(t.Index<0)return alert(t.Message),-1;var n=$("#TgLstBx").children(),d=n.first(),c=$('<div><label><input type="checkbox"/><span/></lable></div>');for(var l in t.Extend){var f=t.Extend[l],u=c.clone().addClass("OneTg").appendTo(d);u.children("label").children("input:checkbox").val(f.ID).end().children("span").addClass("Block").text(f.Nm)}n.eq(1).children("input:button").first().on("click",e).end().eq(1).on("click",r),i=Frame("#Main",200,200,function(){return n},"Frm","標籤過濾",!0),i.attr("id",a).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(i)}),o=RelatedFrameRectangle(s,[i.outerWidth(),i.outerHeight()]),FrameShow(i,o[0],o[1])}}),0)}function i(t){t.stopPropagation();var e=$(t.currentTarget),n=e.attr("id"),r=e.children("div:first").text(),a=(e.data("Pswd"),"random"===e.attr("name"));if(0===n.length)return-1;var i=$("#Frm_"+n);if(i.length>0){var o=e.closest(".Frm"),s=RelatedFrameRectangle(o,[i.width(),i.height()],[0,e.offset().top-o.offset().top]);return FrameShow(i,s[0],s[1]),1}BlogOneFrame(n,a,r,t.currentTarget)}{var o="BlgLstFrm",s=$("#"+o),d=[280,520];$("#MsgBrdFrm")}return s.length>0?(FrameShow(s),0):(s=Frame("#Main",d[0],d[1],e,"Frm",t,!0),s.attr({id:o}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(s)}),FrameShow(s,BaseFrameXGet(s)),0)}function BlogOneFrame(t,e,n,r,a){function i(t){var e=$("<div><pre/></div>");e.addClass("Blog Text").children(":first-child").html(TextToHTML(t.Info.Str));var n=Frame("#Main",515,400,function(){return e},"Frm",t.Ttl,!0);return n.attr("id","Frm_"+t.ID)}function o(t){function e(){var t=$(this);t.width()>t.height()&&t.after("<br/>")}var n=[400,380],r=$("<div><img/><pre/><br/></div>");r.addClass("Blog Img").children("img").attr({src:t.Info.ImgURL,title:"縮圖/原圖切換"}).css({maxWidth:n[0],maxHeight:n[1]}).on("click",[n[0],n[1]],d).on("click",function(){$(this).closest(".Frm").find("> div:first > span:last > span:eq(2)").click()}).one("load",e).end().children("pre").html(TextToHTML(t.Info.Str));var a=Frame("#Main",515,400,function(){return r},"Frm",t.Ttl,!0);return a.attr("id","Frm_"+t.ID),a}function s(t){var e=[400,300],n=$("<div/>").addClass("Blog Imgs");for(var r in t.Lst){var a=t.Lst[r],i=$("<div><img/><div><span>▲</span> <span/></div></div>");i.css({minWidth:e[0]}).children("img").addClass("Unload").attr("src",a.TbnURL).data("TglSzURL",a.ImgURL).css({maxWidth:e[0],maxHeight:e[1]}).on("click",[e[0],e[1]],d).on("load",function(){$(this).removeClass("Unload")}).end().find("> div:first > span:eq(1)").css({maxWidth:e[0]-10}).html(TextToHTML(a.Str)).end().appendTo(n),0===a.Str.length&&i.find("> div > span:first").text("")}var o=Frame("#Main",515,400,function(){return n},"Frm",t.Ttl,!0);return o.attr("id","Frm_"+t.ID),o}function d(t){t.stopPropagation();var e=$(t.currentTarget),n=[e.css("maxWidth"),e.css("maxHeight")],r="none"===n[0]||0===n[0].length?t.data[0]:"",a="none"===n[1]||0===n[1].length?t.data[1]:"",i=e.data("TglSzURL");if(e.css({maxWidth:r,maxHeight:a}),"string"==typeof i&&i.length>0){var o=e.attr("src");o!==i&&e.attr("src",i).data("TglSzURL",o)}}function c(t,e,n){function r(t){return 13!==t.keyCode?-1:void a(t)}function a(e){var n=$(e.currentTarget).siblings().addBack().filter("input:password:first").val();t(n)}if("function"!=typeof t)return-1;var i="PswdFrm",o=$("#"+i),s=$("#PswdBx"),d=$(n),c=d.closest(".Frm"),l=null;if(o.length>0)l=RelatedFrameRectangle(c,[o.width(),o.height()],[0,d.offset().top-c.offset().top]);else{var f=$("#Main");o=Frame(f,280,100,function(){return s},"Frm","輸入密碼",!0),o.attr({id:i}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(o)}),l=0===d.length||0===c.length?[(f.width()-o.outerWidth())/2,30]:RelatedFrameRectangle(c,[o.width(),o.height()],[0,d.offset().top-c.offset().top])}e="string"==typeof e&&e.length>0?"請輸入「"+e+"」的密碼:":"請輸入密碼:";var u=s.find("> div:first > span.Block:first").text(e).end().children("input:button:first").off("click").on("click",a).end().children("input:password:first").off("keypress").on("keypress",r).val("");return FrameShow(o,l[0],l[1]),setTimeout(function(){u.focus()},1e3),0}function l(t){$(t.currentTarget).next("span").toggle()}function f(t){var e=$(this),n=e.find("> span:last input:button:first");"number"!=typeof t&&(t=0),n.val(t>0?"訪客回應 ("+t.toString()+")":"訪客回應"),e.data("CmtCnt",t)}function u(){var t=$(this),e=t.data("CmtCnt");return"undefined"==typeof e&&(e=0),e}return"string"!=typeof t||0===t.length?-1:(e="boolean"==typeof e&&e?1:0,"string"!=typeof a&&(a=""),$.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:{Cmd:2,ID:t,Rdm:e,Pswd:a},success:function(a){if(a.Index<0)return alert(a.Index+", "+a.Message),-1;if(a.Index>0)return a.Index>1&&alert(a.Message),c(function(a){BlogOneFrame(t,e,n,r,a)},n,r),-2;var d=$("#PswdFrm");d.length>0&&FrameHide(d);var p=null;switch(a.Extend.Tp){case"text":p=i(a.Extend);break;case"image":p=o(a.Extend);break;case"images":p=s(a.Extend);break;default:return alert("working on it."),0}var h=p.get(0),g=$('<span><input type="checkbox"/><span/></span>');h.CommentCountSet=f,h.CommentCountGet=u,g.addClass("Ftr").appendTo(p).children("input:checkbox").attr("title","進階選項").change(l).end().children("span").css({display:"none"});var m=$("<div><span/><span></div>");if(m.appendTo(g.children("span:first")).children("span").first().text("建立時間：").end().last().text(a.Extend.Dt),a.Extend.TgA.length>0){var v=$("<div><span/><span/></div>");v.appendTo(g.children("span:first")).children("span").first().text("標籤：");for(var x in a.Extend.TgA){var C=a.Extend.TgA[x];$("<span/>").attr("name",C.ID).text(C.Nm).appendTo(v.children("span:last"))}}var b=$("<div><span/><a/><a/><a/><a/><a/></div>"),I=encodeURIComponent(a.Extend.URL),w="http://www.facebook.com/share.php?u="+I,T="https://plus.google.com/share?url="+I,y="http://twitter.com/intent/tweet?url="+I,F="http://www.plurk.com/?qualifier=shares&status="+I+" ("+n+")";b.appendTo(g.children("span:first")).children("span:first").text("分享網址：").end().children("a").attr("target","_blank").eq(0).addClass("IcoShr IcoLnk").attr({href:a.Extend.URL,title:"直接連結"}).end().eq(1).addClass("IcoShr IcoFb").attr({href:w,title:"分享至 Facebook"}).end().eq(2).addClass("IcoShr IcoGp").attr({href:T,title:"分享至 Google+"}).end().eq(3).addClass("IcoShr IcoTtr").attr({href:y,title:"分享至 Twitter"}).end().eq(4).addClass("IcoShr IcoPlk").attr({href:F,title:"分享至 Plurk"}),a.Extend.Pswd.length>0&&$("<span/>").addClass("IcoBlogTp IcoBlogLck").attr({title:"上鎖的文章"}).prependTo(b);var k=$('<input type="button"/>');k.appendTo(g.children("span:first")).addClass("Btn0").on("click",BlogCommentListFrame),h.CommentCountSet("undefined"!=typeof a.Extend.CmtCnt&&a.Extend.CmtCnt>0?parseInt(a.Extend.CmtCnt,10):0);var M=[p.width(),p.height()],L=[0,0];if("object"==typeof r&&null!==r){var S=$(r),B=S.closest(".Frm");L=RelatedFrameRectangle(B,M,[0,S.offset().top-B.offset().top])}else L=[Math.max(($(document).width()-M[0])/2,0),30];FrameShow(p,L[0],L[1])}}),0)}function BlogCommentListFrame(t){function e(){var t=$("#BlogCmtLstBx").clone().removeAttr("id").children(),e=$("#LvBx").clone().removeAttr("id");return t.last().children("input:button").on("click",n).end().append(e).children("div:last").css({padding:5,borderWidth:1,borderRadius:5}).hide().find("input:button").on("click",r),"string"==typeof CO.GstNm&&t.last().find("input:text.Nm").val(CO.GstNm).end().find("input:checkbox.RmbMe").prop("checked",!0),ItemList(t.first(),"service.php",-1,{Cmd:8,ID:c},a,[]),t}function n(){var t=$(this),e=t.next();if("none"===e.css("display")){var n=t.parent().prev();t.val("取消留言"),e.show().find("input:text:first").focus(),n.parent().animate({scrollTop:n.height()},0)}else t.val("新留言"),e.hide()}function r(t){t.stopPropagation();var e=$(this),n=e.closest(".Frm").attr("id").replace("BlogCmtLstFrm_",""),r=e.parent(),a=r.find("input:text.Ml"),i=r.find("textarea:first"),o={Cmd:9,TgtID:n,Nm:Trim(r.find("input:text.Nm").val()),Ml:Trim(a.val()),Cmt:Trim(i.val())},s=r.find("input:checkbox.RmbMe").prop("checked"),d="";return"string"!=typeof o.TgtID||0===o.TgtID.length?(alert("出錯了!!!"),-1):(0===o.Nm.length&&(o.Nm="匿名",$("#Nm").val(o.Nm)),s?(CookieSet("GstNm",o.Nm,CO.LfTm),CO.GstNm=o.Nm):(CookieSet("GstNm",o.Nm,-1*CO.LfTm),CO.GstNm=""),0===o.Ml.length?d+="尚未填寫 E-Mail。\n":IsEMail(o.Ml)||(d+="E-Mail 不符合標準格式。\n"),0===o.Cmt.length?d+="尚未填寫任何留言。\n":o.Cmt.length>255&&(d+="留言請勿超個 255 個字。\n"),d.length>0?(alert("請留意以下說明：\n"+d),0):void $.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:o,beforeSend:function(){e.get(0).Lock()},error:function(){alert("出錯了!!!")},complete:function(){e.get(0).Unlock()},success:function(t){if(t.Index<0)return alert(t.Index+", "+t.Message),0;a.add(i).val(""),r.prev("input:button").click().parent().prev().get(0).PageGet(0);var e=$("#Frm_"+n);if(e.length>0){var o=e.get(0);o.CommentCountSet(o.CommentCountGet()+1)}}}))}function a(t,e){var n=$("#OneMsgCmt").clone().removeAttr("id");return e=parseInt(e,10)+1,n.children().first().text(t.Nm).end().eq(1).html(TextToHTML(t.Cmt)).end().eq(2).text(t.Dt).end().last().text("#"+e.toString()),n}t.stopPropagation();var i=$(this),o=i.closest(".Frm"),s=o.find("> div:first > span:first").text()+" > 訪客留言",d=[],c=o.attr("id").replace("Frm_",""),l="BlogCmtLstFrm_"+c,f=$("#"+l);return f.length>0?(d=RelatedFrameRectangle(o,[f.width(),f.height()]),FrameShow(f,d[0],d[1]),0):(f=Frame("#Main",360,320,e,"Frm",s,!0),d=RelatedFrameRectangle(o,[f.width(),f.height()]),f.attr("id",l),FrameShow(f,d[0],d[1]),0)}function MessageListFrame(t){function e(){return ItemList(c,"service.php",5,{Cmd:3},n,["LstIdxTg","LstIdxTgDsb"]),$("#NewMsgBtn").on("click",r),$("#RldMsgLstBtn").on("click",a),c.on("click",".OneMsg > input:button:last-child",i),c.parent("div")}function n(t){var e=$("#OneMsg").clone().removeAttr("id"),n=e.attr({id:t.ID}).children().first().text(t.Nm).end().eq(1).html(TextToHTML(t.Msg)).end().eq(2).text(t.Dt).end().last();return!isNaN(t.ChnCnt)&&t.ChnCnt>0?n.val(t.ChnCnt).show():(n.val(n.attr("title")),e.on({mouseenter:function(){$(this).children("input:button:last").toggle()},mouseleave:function(){$(this).children("input:button:last").toggle()}})),e}function r(t){t.stopPropagation();var e="MsgLvFrm",n=$("#"+e),r=$(this),a=r.closest(".Frm"),i=null,s=null;return n.length>0?(i=n.find(".LvBx"),s=RelatedFrameRectangle(a,[n.width(),n.height()]),i.children("input:text.Ml, textarea").val(""),FrameShow(n,s[0],s[1])):(i=$("#LvBx").clone().removeAttr("id"),n=Frame("#Main",360,200,function(){return i
},"Frm","新留言",!0),s=RelatedFrameRectangle(a,[n.width(),n.height()]),i.children("input:button:last").on("click",o),n.attr("id",e).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(n)}),FrameShow(n,s[0],s[1])),"string"!=typeof CO.GstNm||0===CO.GstNm.length?i.children("input:text:first").val("").focus().end().find("> label > input:checkbox:first").prop("checked",!1):i.children("input:text.Nm").val(CO.GstNm).focus().end().find("> label > input:checkbox:first").prop("checked",!0),0}function a(){var t=c.get(0),e=parseInt($("#MxLmt").val(),10);t.LimitSet(e),t.Recount(function(){t.PageGet(0)})}function i(t){function e(){var t=$("#MsgChnBx").clone().removeAttr("id"),e=$("#LvBx").clone().removeAttr("id");return t.children("div:first").replaceWith(s.clone().removeAttr("id")).end().children("div:first").children("input:button:last").remove().end().end().children("div:last").append(e).children("input:button:first").on("click",n).end().children("div:first").hide().css({padding:5,borderWidth:1,borderRadius:5}).children("input:button:last").on("click",o),ItemList(t.children("div:eq(1)"),"service.php",-1,{Cmd:5,ID:d},r,[]),t}function n(){var t=$(this),e=t.next("div");if("none"===e.css("display")){var n=t.parent().parent();t.val("取消留言"),e.show().children("input:text:first").focus(),n.parent().animate({scrollTop:n.height()},0),"string"==typeof CO.GstNm&&CO.GstNm.length>0&&e.children("input:text:first").val(CO.GstNm).end().find("> label:first > input:checkbox:first").prop("checked",!0)}else t.val("新留言"),e.hide().children("input:text").val("").end().children("textarea").val("")}function r(t,e){var n=$("#OneMsgCmt").clone().removeAttr("id");return e=parseInt(e,10)+1,n.attr({id:t.ID}).children().first().text(t.Nm).end().eq(1).html(TextToHTML(t.Msg)).end().eq(2).text(t.Dt).end().eq(3).text("#"+e.toString()),n}var a,i=$(t.currentTarget),s=i.parent(),d=s.attr("id"),c=$("#Msg_"+d),l=s.children("div:first").text()+" 的留言串",f=i.closest(".Frm");return c.length>0?(a=RelatedFrameRectangle(f,[c.width(),c.height()],[0,i.offset().top-f.offset().top]),FrameShow(c,a[0],a[1]),0):(c=Frame("#Main",360,320,e,"Frm",l,!0),a=RelatedFrameRectangle(f,[c.width(),c.height()],[0,i.offset().top-f.offset().top]),c.attr("id","Msg_"+d),FrameShow(c,a[0],a[1],function(){c.find("> div:first > span:last > span:eq(1)").click().click()}),c.get(0).ChainReload=function(){c.find(".MsgChnBx > div:eq(1)").get(0).PageGet(0)},0)}function o(){var t=$(this),e=t.closest(".Frm").attr("id").replace(/^Msg_|^MsgLvFrm/,""),n={Cmd:4,Nm:Trim(t.prevAll("input:text.Nm:first").val()),Ml:Trim(t.prevAll("input:text.Ml:first").val()),Msg:Trim(t.prevAll("textarea.Msg:first").val())},r=t.prev("label").children("input:checkbox").prop("checked"),a="";return 0===n.Nm.length&&(n.Nm="匿名"),r?(CookieSet("GstNm",n.Nm,CO.LfTm),CO.GstNm=n.Nm):(CookieSet("GstNm",n.Nm,-1*CO.LfTm),CO.GstNm=""),0===n.Ml.length?a+="尚未填寫 E-Mail。\n":IsEMail(n.Ml)||(a+="E-Mail 不符合標準格式。\n"),0===n.Msg.length?a+="尚未填寫任何留言。\n":n.Msg.length>255&&(a+="留言請勿超個 255 個字。\n"),a.length>0?(alert("請留意以下說明：\n"+a),0):("string"==typeof e&&e.length>0&&(n.Tgt=e),void $.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:n,beforeSend:function(){t.get(0).Lock()},error:function(){alert("出錯了!!!")},complete:function(){t.get(0).Unlock()},success:function(n){if(n.Index<0)return alert(n.Index+", "+n.Message),0;var r=$("#Msg_"+e);r.length>0&&r.get(0).ChainReload(),t.parent().prev("input:button").click(),$("#RldMsgLstBtn").click(),FrameHide($("#MsgLvFrm"))}}))}{var s="MsgBrdFrm",d=$("#"+s),c=$("#MsgLstBx"),l=[320,520];$("#BlgLstFrm"),$("#TtlLstFrm")}return d.length>0?(FrameShow(d),0):(d=Frame("#Main",l[0],l[1],e,"Frm",t,!0),d.attr({id:s}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(d)}),FrameShow(d,BaseFrameXGet(d)),0)}function TutorialListFrame(t){function e(){function t(t,e){var n=$("<div/>");return n.addClass("OneItm OneTtrl").data("URL","text_read.php?Fl="+encodeURIComponent(t)).attr("name","Tutorial_"+e.toString()).text(t),n}function e(t){function e(){var t=$("<iframe/>");return t.attr("src",i).css({width:o[0],height:o[1]-1,border:"0px"}),t}function n(){var t=d.children("div:eq(1)");d.find("iframe:first").css({width:t.width(),height:t.height()-1})}var r=$(t.currentTarget),a=r.text(),i=r.data("URL"),o=[640,480],s=r.attr("name"),d=$("#"+s);0===d.length&&(d=Frame("#Main",o[0],o[1],e,"Frm",a,!0),d.get(0).ActionExtend("SizeChange",n)),FrameShow(d,BaseFrameXGet(d))}var n=$("<div/>");return ItemList(n,"service.php",-1,{Cmd:10},t,!0),n.on("click","> div",e),n}var n="TtlLstFrm",r=$("#"+n);return r.length>0?(FrameShow(r),0):(r=Frame("#Main",240,240,e,"Frm",t,!0),r.attr({id:n}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(r)}),FrameShow(r,BaseFrameXGet(r)),0)}function CustomFrame(t){function e(){var t=$('<input type="text"/><br/><span/><br/><input type="button"/>');return t.filter("span:first").text("(部分網站會禁止其它網站的內嵌引用。)").css("color","#ff0000").end().filter("input").css("marginTop",10).filter(":text:first").on("keypress",n).end().filter(":button:first").val("確定").addClass("Btn0").on("click",r),t}function n(t){13===t.keyCode&&$(this).nextAll("input:button:first").click()}function r(){function t(){var t=$("<iframe/>");return t.attr("src",r).css({width:n[0],height:n[1],border:"0px"}),t}function e(){var t=s.children("div:eq(1)");t.children("iframe").width(t.width()).height(t.height())}var n=[640,480],r=$(this).prevAll("input:text").val();if(0===r.length)return 0;var a=r.substr(0,7);"http://"!==a&&"https:/"!==a&&(r="http://"+r),FrameHide(i);var o=$("#Main"),s=Frame("#Main",n[0],n[1],t,"Frm",r,!0);return s.get(0).ActionExtend("SizeChange",e),FrameShow(s,(o.width()-s.outerWidth())/2,o.offset().top+5),0}var a="CstURLFrm",i=$("#"+a),o=[320,100];if(i.length>0)return FrameShow(i,null,null,function(){i.find("> div:eq(1) > input:text:first").focus()}),0;i=Frame("#Main",o[0],o[1],e,"Frm",t,!0),i.attr({id:a}).get(0).ActionExtend("CloseButtonClick",function(){FrameHide(i)});var s=$("#Main"),d=i.children("div:eq(1)").css("textAlign","center").children("input:text:first");return FrameShow(i,(s.width()-i.outerWidth())/2,s.offset().top+5,function(){d.focus()}),0}function GoodWordsSet(){function t(){$.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:{Cmd:11},success:function(t){return t.Index<0?-1:(i=t.Extend.Wds,e(),void n())}})}function e(){o.attr({width:o.width(),height:o.height()}),s=o.get(0).getContext("2d"),s.textBaseline="middle";for(var t=[40,25],e=i.replace(/\n|，|；|。| /g,"\n").split("\n"),n=0;n<e.length;n++)for(var r=[80,s.canvas.height-t[1]*(e.length-n+1)],c=0;c<e[n].length;c++){var l=e[n].charAt(c),f=[a(64,128).toString(),a(64,192).toString(),a(64,255).toString(),a(.2,.9,2).toString()],u=a(20,50),p={Chr:l,DftLct:[r[0]+c*t[0]+a(-5,5),r[1]+a(-5,5)],Lct:[a(0,s.canvas.width,2),a(0,s.canvas.height,2)],Drct:[a(-1,1,2),a(-1,1,2)],Sz:u,Clr:"rgba("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+")",Fnt:"italic bold "+u.toString()+"px sans-serif"};d.push(p)}}function n(){s.clearRect(0,0,s.canvas.width,s.canvas.height),r()}function r(){for(var t=0;t<d.length;t++)d[t].Lct[0]=d[t].DftLct[0],d[t].Lct[1]=d[t].DftLct[1],s.font=d[t].Fnt,s.fillStyle=d[t].Clr,s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=0,s.fillText(d[t].Chr,d[t].Lct[0],d[t].Lct[1])}function a(t,e,n){if("number"!=typeof t||"number"!=typeof e)return 0;if("number"!=typeof n&&(n=0),t>e||t>e){var r=t;t=e,e=r}var a=e-t,i=Math.random()*a+t;if(0===n)i=Math.floor(i);else if(n>0){var o=Math.pow(10,n);i=Math.floor(i*o)/o}return i}var i="",o=$("canvas#GdWds"),s=null,d=[];return t(),0}function ArtCornerSet(){function t(){$.ajax({type:"POST",dataType:"json",timeout:2e4,url:"service.php",data:{Cmd:6},success:function(t){return t.Index<0?-1:void e.css("backgroundImage",'url("'+t.Extend.ImgURL+'")').children().text(t.Extend.Ttl+"\n"+t.Extend.Dt.substr(0,10)+"\nby "+t.Extend.Atr)}})}var e=$("#AtCnr"),n=$("#AtCnrChk");return n.on({mouseenter:function(){e.children().show()},mouseleave:function(){e.children().hide()}}),t(),e}function KeyboardCommand(t){function e(t){var e=n.data("KyBfr")+t.keyCode.toString(16),r=["41444d494e","525a","55504c4f4144"],a=0;for(var i in r)a=Math.max(a,r[i].length);e.length>a&&(e=e.substr(2)),e.indexOf(r[0])>=0?(n.data("KyBfr",""),PageTurn("admin.php")):e.indexOf(r[1])>=0?(n.data("KyBfr",""),PageTurn("rz.php")):e.indexOf(r[2])>=0?(n.data("KyBfr",""),PageTurn("upload/upload.php")):n.data("KyBfr",e)}if("string"!=typeof t)return 0;var n=$(document),r=function(){};return(0===t.length||"index.php"===t)&&(r=e),n.data("KyBfr","").keyup(r),0}Z_Check_API();